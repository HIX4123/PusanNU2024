![alt text](<Microcontroller Architecture Overview.png>)

4단계 파이프라인에 따라 기존 아키텍처의 순서를 정렬했고, 파이프라인 하자드의 발생을 해결하기 위해 가상의 제어 유닛을 추가했습니다.

하자드 제어 유닛에서는 data fetch를 시도하는 과정이 유효할 경우 기존대로 절차를 수행시키고, 그렇지 않을 때는 디코드 되었던 함수의 주소를 자체적으로 저장해 두었다 버스 컨트롤 로직에 우선해서 명령 큐 버퍼로 전달합니다.

파이프라인이 4단계로 구성되어 있기 때문에 동시에 최대 3개의 하자드가 발생할 수 있다고 가정해, 하자드 유닛은 자체로 버퍼 레지스터를 3개까지 가지고 있다고 가정했습니다.

또한 순서도에는 명시하지 않았지만, 버스 컨트롤 로직에 우선에서 명령 큐 버퍼로 주소를 전달해야 하므로, 버스 컨트롤 로직에서 하자드 제어 유닛의 반환값을 받을 수 있도록 해야 합니다.
